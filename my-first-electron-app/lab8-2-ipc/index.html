<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lab 8.2 - IPC Communication Demo</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      min-height: 100vh;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.1);
      padding: 30px;
      border-radius: 15px;
      backdrop-filter: blur(10px);
    }
    
    .header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .demo-section {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
    }
    
    .input-group {
      margin: 15px 0;
    }
    
    .input-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    
    .input-group input {
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      box-sizing: border-box;
    }
    
    .button {
      background: rgba(255, 255, 255, 0.2);
      border: 2px solid white;
      color: white;
      padding: 12px 24px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 16px;
      margin: 10px 5px;
      transition: all 0.3s ease;
    }
    
    .button:hover {
      background: white;
      color: #667eea;
      transform: translateY(-2px);
    }
    
    .button-small {
      padding: 8px 16px;
      font-size: 14px;
    }
    
    .result-box {
      background: rgba(0, 0, 0, 0.2);
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      font-family: monospace;
      white-space: pre-wrap;
      max-height: 300px;
      overflow-y: auto;
    }
    
    .loading { color: #ffd700; font-style: italic; }
    .success { 
      background: rgba(46, 125, 50, 0.2) !important;
      border-left: 4px solid #2e7d32;
    }
    .error { 
      background: rgba(211, 47, 47, 0.2) !important;
      border-left: 4px solid #d32f2f;
    }
    .info { 
      background: rgba(33, 150, 243, 0.2) !important;
      border-left: 4px solid #2196f3;
    }
    
    .agent-card {
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
    }
    
    .status-available { color: #4caf50; }
    .status-busy { color: #f44336; }
    .status-break { color: #ff9800; }
    .status-offline { color: #9e9e9e; }
    
    .hidden { display: none; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üîÑ IPC Communication Demo</h1>
      <p>‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Main Process ‡πÅ‡∏•‡∏∞ Renderer Process</p>
    </div>

    <!-- Demo 1: ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô -->
    <div class="demo-section">
      <h3>üì§ Demo 1: ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏õ Main Process</h3>
      <p>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö response ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤</p>
      
      <div class="input-group">
        <label>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á:</label>
        <input type="text" id="messageInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." value="Hello from Renderer Process!">
      </div>
      
      <button class="button" onclick="sendMessage()">üì§ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
      <button class="button" onclick="clearResult('messageResult')">üßπ ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå</button>
      
      <div class="result-box" id="messageResult">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö IPC</div>
    </div>

    <!-- üîê Demo 2+4: ‡∏£‡∏∞‡∏ö‡∏ö Login Agent + ‡∏ó‡∏±‡∏Å‡∏ó‡∏≤‡∏¢ (‡∏£‡∏ß‡∏°‡πÅ‡∏•‡πâ‡∏ß) -->
    <div class="demo-section">
      <h3>üîê ‡∏£‡∏∞‡∏ö‡∏ö Login Agent</h3>
      <p>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏Å‡∏ó‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</p>
      
      <div class="input-group">
        <label>Agent ID:</label>
        <input type="text" id="loginAgentId" placeholder="‡πÄ‡∏ä‡πà‡∏ô AG001, AG002, AG003" value="AG001">
      </div>
      
      <div class="input-group">
        <label>Password:</label>
        <input type="password" id="loginPassword" placeholder="password001, password002, ..." value="password001">
      </div>
      
      <button class="button" onclick="login()">üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
      <button class="button" onclick="clearLoginForm()">üßπ ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      <button class="button" onclick="showTestAccounts()">üìã ‡∏î‡∏π‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>
      
      <div class="result-box info" id="loginResult">
        <strong>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</strong><br>
        ‚Ä¢ AG001 / password001 (Alice Johnson)<br>
        ‚Ä¢ AG002 / password002 (Bob Smith)<br>
        ‚Ä¢ AG003 / password003 (Carol Lee)<br>
        <br>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
      </div>

      <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Agent ‡∏´‡∏•‡∏±‡∏á Login -->
      <div id="agentDashboard" class="hidden">
        <div class="agent-card" id="agentInfo">
          <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Agent ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
        </div>
        
        <button class="button" onclick="changeMyStatus()">üîÑ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</button>
        <button class="button" onclick="logout()">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>

    <!-- Demo 3: Agent Wallboard -->
    <div class="demo-section">
      <h3>üìä Agent Wallboard</h3>
      <p>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• agents ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
      
      <button class="button" onclick="loadAgents()">üìä ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Agents</button>
      <button class="button" onclick="showStatusSelector()">üîÑ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Agent</button>
      
      <div id="statusSelector" style="display: none; margin: 15px 0;">
        <select id="agentSelect" style="padding: 8px; margin-right: 10px;">
          <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Agent</option>
        </select>
        
        <select id="statusSelect" style="padding: 8px; margin-right: 10px;">
          <option value="Available">Available</option>
          <option value="Busy">Busy</option>
          <option value="Break">Break</option>
          <option value="Offline">Offline</option>
        </select>
        
        <button class="button button-small" onclick="changeStatus()">‚úÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
      </div>
      
      <div class="result-box" id="agentResult">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Agents" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</div>
    </div>

    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Process -->
    <div class="demo-section">
      <h3>üìä Process Information</h3>
      <div class="result-box">
üñ•Ô∏è <strong>Main Process:</strong> ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô Node.js environment, ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ business logic
üé® <strong>Renderer Process:</strong> ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô Chromium environment, ‡πÅ‡∏™‡∏î‡∏á UI
üåâ <strong>Preload Script:</strong> ‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö IPC communication

<strong>üîÑ ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:</strong>
1. Renderer ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å window.electronAPI.sendMessage()
2. Preload ‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ Main ‡∏î‡πâ‡∏ß‡∏¢ ipcRenderer.invoke()
3. Main ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏î‡πâ‡∏ß‡∏¢ ipcMain.handle()
4. Main ‡∏™‡πà‡∏á response ‡∏Å‡∏•‡∏±‡∏ö
5. Renderer ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
      </div>
    </div>
  </div>

  <script>
    console.log('üé® [RENDERER] ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...');
    let currentAgent = null;

    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ electronAPI ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
    if (window.electronAPI) {
      console.log('‚úÖ [RENDERER] electronAPI ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
    } else {
      console.error('‚ùå [RENDERER] electronAPI ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
    }

    // ===== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å =====

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
    function displayResult(elementId, data, type = 'info') {
      const element = document.getElementById(elementId);
      const timestamp = new Date().toLocaleTimeString('th-TH');
      
      let content;
      if (typeof data === 'object') {
        content = JSON.stringify(data, null, 2);
      } else {
        content = data.toString();
      }
      
      element.innerHTML = `[${timestamp}] ${content}`;
      element.className = `result-box ${type}`;
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
    async function sendMessage() {
      const message = document.getElementById('messageInput').value;
      
      if (!message.trim()) {
        displayResult('messageResult', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°', 'error');
        return;
      }

      try {
        console.log('üì§ [RENDERER] ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°:', message);
        displayResult('messageResult', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...', 'loading');
        
        const response = await window.electronAPI.sendMessage(message);
        console.log('üì• [RENDERER] ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö response:', response);
        displayResult('messageResult', response, 'success');
        
      } catch (error) {
        console.error('‚ùå [RENDERER] Error:', error);
        displayResult('messageResult', `Error: ${error.message}`, 'error');
      }
    }

    // üîê ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Agent
    async function login() {
      const agentId = document.getElementById('loginAgentId').value.trim();
      const password = document.getElementById('loginPassword').value.trim();
      
      if (!agentId || !password) {
        displayLoginResult('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Agent ID ‡πÅ‡∏•‡∏∞ Password', 'error');
        return;
      }

      try {
        console.log('üîê [RENDERER] ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...', agentId);
        displayLoginResult('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...', 'loading');
        
        const result = await window.electronAPI.login(agentId, password);
        
        if (result.success) {
          console.log('‚úÖ [RENDERER] ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', result.agent);
          currentAgent = result.agent;
          
          const successMessage = `
üéâ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!

üë§ <strong>Agent:</strong> ${result.agent.name}
üÜî <strong>ID:</strong> ${result.agent.id}
üè¢ <strong>‡πÅ‡∏ú‡∏ô‡∏Å:</strong> ${result.agent.department}
üìû <strong>Extension:</strong> ${result.agent.extension}
üü¢ <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${result.agent.status}

‚úÖ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß!`;

          displayLoginResult(successMessage, 'success');
          showAgentDashboard(result.agent);
          localStorage.setItem('currentAgent', JSON.stringify(result.agent));
          
        } else {
          console.log('‚ùå [RENDERER] ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:', result.message);
          displayLoginResult(result.message, 'error');
        }
        
      } catch (error) {
        console.error('‚ùå [RENDERER] Error ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö:', error);
        displayLoginResult(`Error: ${error.message}`, 'error');
      }
    }

    // ‡πÅ‡∏™‡∏î‡∏á Dashboard ‡∏´‡∏•‡∏±‡∏á Login
    function showAgentDashboard(agent) {
      document.getElementById('agentDashboard').classList.remove('hidden');
      document.getElementById('agentInfo').innerHTML = `
        <h4>üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h4>
        <strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ${agent.name}<br>
        <strong>ID:</strong> ${agent.id}<br>
        <strong>‡πÅ‡∏ú‡∏ô‡∏Å:</strong> ${agent.department}<br>
        <strong>Extension:</strong> ${agent.extension}<br>
        <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> <span class="status-${agent.status.toLowerCase()}">${agent.status}</span><br>
        <strong>Login Time:</strong> ${new Date().toLocaleString('th-TH')}
      `;
    }

    // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
    async function changeMyStatus() {
      if (!currentAgent) return;
      
      const newStatus = prompt('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏´‡∏°‡πà (Available, Busy, Break, Offline):', currentAgent.status);
      if (newStatus && ['Available', 'Busy', 'Break', 'Offline'].includes(newStatus)) {
        try {
          const result = await window.electronAPI.changeAgentStatus(currentAgent.id, newStatus);
          if (result.success) {
            currentAgent.status = newStatus;
            showAgentDashboard(currentAgent);
            displayLoginResult(`‚úÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô ${newStatus} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`, 'success');
          }
        } catch (error) {
          displayLoginResult(`‚ùå Error: ${error.message}`, 'error');
        }
      }
    }

    // ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
    function logout() {
      currentAgent = null;
      localStorage.removeItem('currentAgent');
      document.getElementById('agentDashboard').classList.add('hidden');
      displayLoginResult('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'info');
    }

    // üßπ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° login
    function clearLoginForm() {
      document.getElementById('loginAgentId').value = '';
      document.getElementById('loginPassword').value = '';
      displayLoginResult('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'info');
    }

    // üìã ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö
    function showTestAccounts() {
      const testAccounts = `
<strong>üìã ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</strong>

üü¢ <strong>AG001</strong> / password001
   üë§ Alice Johnson (Sales)
   üìû Extension: 1001

üî¥ <strong>AG002</strong> / password002  
   üë§ Bob Smith (Support)
   üìû Extension: 1002

üü° <strong>AG003</strong> / password003
   üë§ Carol Lee (Sales)
   üìû Extension: 1003

üí° <em>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö"</em>
      `;
      displayLoginResult(testAccounts, 'info');
    }

    // üéØ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå login
    function displayLoginResult(message, type = 'info') {
      const element = document.getElementById('loginResult');
      const timestamp = new Date().toLocaleTimeString('th-TH');
      element.innerHTML = `[${timestamp}] ${message}`;
      element.className = `result-box ${type}`;
    }

    // ===== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Agent Wallboard =====
    let agentsData = null;

    async function loadAgents() {
      try {
        console.log('üìä [RENDERER] ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• agents...');
        displayResult('agentResult', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• agents...', 'loading');
        
        const response = await window.electronAPI.getAgents();
        
        if (response.success) {
          agentsData = response.data;
          console.log('‚úÖ [RENDERER] ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', agentsData);
          displayAgentData(agentsData);
          updateAgentSelector(agentsData.agents);
        } else {
          throw new Error(response.error);
        }
      } catch (error) {
        console.error('‚ùå [RENDERER] Error ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error);
        displayResult('agentResult', `Error: ${error.message}`, 'error');
      }
    }

    function displayAgentData(data) {
      const agentList = data.agents.map(agent => {
        const statusEmoji = { 'Available': 'üü¢', 'Busy': 'üî¥', 'Break': 'üü°', 'Offline': '‚ö´' };
        return `${statusEmoji[agent.status] || '‚ùì'} ${agent.name} (${agent.id})
   üìû Ext: ${agent.extension} | üè¢ ${agent.department}
   üìä Calls: ${agent.totalCalls} | ‚è±Ô∏è Avg: ${agent.avgCallTime}s`;
      }).join('\n\n');
      
      const statistics = data.statistics;
      const resultText = `
üìä AGENT WALLBOARD DATA
======================

üë• AGENTS (${statistics.totalAgents} ‡∏Ñ‡∏ô):
${agentList}

üìà STATISTICS:
üü¢ Available: ${statistics.availableAgents} ‡∏Ñ‡∏ô
üî¥ Busy: ${statistics.busyAgents} ‡∏Ñ‡∏ô  
üü° Break: ${statistics.onBreakAgents} ‡∏Ñ‡∏ô
üìû Total Calls Today: ${statistics.totalCallsToday}
‚è∞ Avg Wait Time: ${statistics.avgWaitTime}s

‚è∞ Last Updated: ${new Date().toLocaleString('th-TH')}`;

      displayResult('agentResult', resultText, 'success');
    }

    function updateAgentSelector(agents) {
      const agentSelect = document.getElementById('agentSelect');
      agentSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Agent</option>';
      agents.forEach(agent => {
        const option = document.createElement('option');
        option.value = agent.id;
        option.textContent = `${agent.name} (${agent.id}) - ${agent.status}`;
        agentSelect.appendChild(option);
      });
    }

    function showStatusSelector() {
      if (!agentsData) {
        displayResult('agentResult', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• agents ‡∏Å‡πà‡∏≠‡∏ô', 'error');
        return;
      }
      const selector = document.getElementById('statusSelector');
      selector.style.display = selector.style.display === 'none' ? 'block' : 'none';
    }

    async function changeStatus() {
      const agentId = document.getElementById('agentSelect').value;
      const newStatus = document.getElementById('statusSelect').value;
      
      if (!agentId || !newStatus) {
        displayResult('agentResult', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Agent ‡πÅ‡∏•‡∏∞ Status', 'error');
        return;
      }
      
      try {
        console.log(`üîÑ [RENDERER] ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ${agentId} ‡πÄ‡∏õ‡πá‡∏ô ${newStatus}`);
        displayResult('agentResult', `‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ${agentId}...`, 'loading');
        
        const response = await window.electronAPI.changeAgentStatus(agentId, newStatus);
        
        if (response.success) {
          const resultText = `
‚úÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!

üë§ Agent: ${response.agent.name} (${response.agent.id})
üîÑ Status: ${response.agent.status}
‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤: ${new Date(response.agent.lastStatusChange).toLocaleString('th-TH')}

${response.message}`;
          displayResult('agentResult', resultText, 'success');
          setTimeout(() => loadAgents(), 2000);
        } else {
          throw new Error(response.error);
        }
      } catch (error) {
        console.error('‚ùå [RENDERER] Error ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:', error);
        displayResult('agentResult', `Error: ${error.message}`, 'error');
      }
    }

    // üîî ‡∏£‡∏∞‡∏ö‡∏ö Notification
    function setupNotificationListener() {
      if (window.electronAPI && window.electronAPI.onAgentStatusChanged) {
        window.electronAPI.onAgentStatusChanged((data) => {
          console.log('üîî [RENDERER] ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö notification:', data);
          alert(`üîî ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ${data.agentName} (${data.agentId}) ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏≤‡∏Å "${data.oldStatus}" ‡πÄ‡∏õ‡πá‡∏ô "${data.newStatus}"`);
        });
        console.log('‚úÖ [RENDERER] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ notification listener ‡πÅ‡∏•‡πâ‡∏ß');
      }
    }

    // ===== Event Listeners =====
    document.getElementById('messageInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') sendMessage();
    });

    document.getElementById('loginAgentId').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') login();
    });

    document.getElementById('loginPassword').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') login();
    });

    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠ page ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
    window.addEventListener('DOMContentLoaded', () => {
      console.log('üìÑ [RENDERER] HTML ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à');
      setupNotificationListener();
      
      // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏≤‡∏Å localStorage (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
      const savedAgent = localStorage.getItem('currentAgent');
      if (savedAgent) {
        currentAgent = JSON.parse(savedAgent);
        showAgentDashboard(currentAgent);
        displayLoginResult('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏≤‡∏Å session ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤', 'info');
      }
    });

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
    function clearResult(elementId) {
      const element = document.getElementById(elementId);
      element.innerHTML = '‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß...';
      element.className = 'result-box';
    }
  </script>
</body>
</html>